name: Create issue for push to prod
on:
  schedule:
    # Runs on the 1st and 15th of each month at 9AM
    - cron: "0 9 1,15 * *"
  pull_request:

jobs:
  create_issue:
    runs-on: ubuntu-latest
    env:
      GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
    steps:
      - uses: actions/checkout@v2

      - name: Set current date as env variable
        run: |
          echo "DATE=$(date +'%Y-%m-%d')" >> GITHUB_ENV

      - name: Create issue
        env:
          label: "push to prod"
        run: |
          title=":rocket: Deploy to production: $DATE"
          body="Deploy to production: $DATE"

          gh issue create --title "${title}" --body "${body}" --label "${label}"
